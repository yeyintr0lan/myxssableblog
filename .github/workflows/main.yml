# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

name: Push and Deploy at Digital Ocean

on:
# Triggers the workflow on push or pull request events but only for the master branch
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
env:
  REGISTRY: "registry.digitalocean.com/devsecopstest"
  IMAGE_NAME: "xssable"
  LOGINPASS: ${{ secrets.LOGINPASS }}



jobs:
     
  
  function_test:
    name: selenium test
    runs-on: ubuntu-latest
    #needs: deploy
    
    steps:
      
    - name: Checkout
      uses: actions/checkout@v2
    
    - name: setup-chromedriver
  # You may pin to the exact commit or the version.
  # uses: nanasess/setup-chromedriver@835cae695490330a7e390033b2b5bd67e6f8055e
      uses: nanasess/setup-chromedriver@v1.0.1
      #with:
    # Optional: do not specify to match Chrome's version
        #chromedriver-version: '88.0.4324.96'
    #- run: chromedriver --url-base=/wd/hub &
    
    - name: Setup Python
      uses: actions/setup-python@v2.2.2
      
      with:
        envs: LOGINPASS,GITHUB_SHA
        # Version range or exact version of a Python version to use, using SemVer's version range syntax.
        python-version: 3 # optional, default is 3.x
        # The target architecture (x86, x64) of the Python interpreter.
        #architecture: # optional
        # Used to pull python distributions from actions/python-versions. Since there's a default, this is typically not supplied by the user.
        token: ${{ secrets.GITHUB_TOKEN }} # optional, default is ${{ github.token }}
        run: |
          python -m pip install --upgrade pip
          pip install selenium
          python seleniumtest.py
    
    - name: custom command
      
      run: |
          python -m pip install --upgrade pip
          pip install selenium
          export LOGINPASS=$LOGINPASS
          python seleniumtest.py
      
  

  
